'use strict';

window.debug = require('debug');
var debug = require('debug')('do:example');
var Server = require('lib/server');
var App = require('lib/app');
var Router = require('lib/router');

var app = new App();
var router = new Router();
var server = new Server(app);


router.add('/page/:pageId', function(req, res, next) {
  req.test = 909;
  next();
}, function(req) {
  req.test2 = 2;
  debug('router /page/:pageId works', arguments);
});

router.add('/mylink.html', function() {
  debug('router /mylink.html works');
});

router.add('/test.html', function() {
  debug('router /test.html works');
});

router.add('*', function() {
  debug('router * works');
});


app.use(function(req, res, next) {
  debug('run', req, res);
  next();
});
app.use(router);
app.use(function(req, res) {
  debug('run2', req, res);
});



//For modern browsers:
document.addEventListener('DOMContentLoaded', function() {
  server.run();
}, false);